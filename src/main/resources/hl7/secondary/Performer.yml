#
# (C) Copyright IBM Corp. 2020
#
# SPDX-License-Identifier: Apache-2.0
#
function_v1:
   condition: $orderingProvider NOT_NULL
   valueOf: datatype/CodeableConcept_var
   expressionType: resource
   constants:
    system: 'http://terminology.hl7.org/CodeSystem/v2-0443'
    code: 'OP'
    text: 'Ordering Provider'

function_v2:
   condition: $administeringProvider NOT_NULL || $idValue NOT_NULL || $rxa27 NOT_NULL || $rxa11 NOT_NULL
   valueOf: datatype/CodeableConcept_var
   expressionType: resource
   constants:
    system: 'http://terminology.hl7.org/CodeSystem/v2-0443'
    code: AP
    text: Administering Provider

actor_1:
   condition: $orderingProvider NOT_NULL || $administeringProvider NOT_NULL
   valueOf: resource/Practitioner
   expressionType: reference
   generateList: true
   specs: $orderingProvider | $administeringProvider

actor_2:
  condition: $idValue NOT_NULL
  valueOf: resource/Organization_ServiceProvider
  expressionType: reference
  vars:
    idValue: $rxa27
    name: $rxa27

actor_3:
  condition: $rxa27 NULL && $rxa11 NOT_NULL && $pv1 NULL
  valueOf: resource/Organization_ServiceProvider
  expressionType: reference
  vars:
    idValue: $rxa11
    name: $rxa11
